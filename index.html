<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./src/favicon.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <title>Pong42</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="stylesheet" href="./css/App.css" />
  <link rel="stylesheet" href="./css/Chat.css" />
  <link rel="stylesheet" href="./css/footer.css" />
  <link rel="stylesheet" href="./css/Home.css" />
  <link rel="stylesheet" href="./css/index.css" />
  <link rel="stylesheet" href="./css/Leaderboard.css" />
  <link rel="stylesheet" href="./css/Login.css" />
  <link rel="stylesheet" href="./css/Profile.css" />
  <link rel="stylesheet" href="./css/Register.css" />
  <link rel="stylesheet" href="./css/Navbar.css" />
  <script
  src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
  integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
  crossorigin="anonymous"
  defer
></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous" defer></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous" defer></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">

<script src="./js/Login.js"></script>
<script src="./js/Chat.js"></script>
<script src="./js/Profile.js"></script>
<script src="./js/Leaderboard.js"></script>
<script src="./js/Logout.js"></script>
</head>
<body>

  <header>
    <h1 class="logo" ><a onclick="route()" class="nav-item" href="/">Pong42</a></h1>
    <input type="checkbox" id="nav-toggle" class="nav-toggle" />
    <nav>
      <ul id="nav-menu">
        <li><a onclick="route()" href="/" class="nav-item" id="home">Home</a></li>
        <li><a onclick="route()" href="/login" class="nav-item" id="login">Login</a></li>
      </ul>
    </nav>
    
    <!-- Language dropdown -->
    
    <label for="nav-toggle" class="nav-toggle-label">
      <span></span>
    </label>

    <div class="language-container">
      <select id="languageSelect" onchange="changeLanguage(this.value)">
        <option value="en">EN</option>
        <option value="at">AT</option>
        <option value="tr">TR</option>
        <option value="bg">BG</option>
        <option value="eg">EG</option>
        <option value="fr">FR</option>
      </select>
    </div>
  </header>
  <script>
    window.addEventListener('beforeunload', function (e) {
      sessionStorage.setItem('isSubPageRefreshed', 'true');
    });

    window.addEventListener('load', function (e) {
      const isSubPageRefreshed = sessionStorage.getItem('isSubPageRefreshed');
      if (isSubPageRefreshed === 'true') {
        sessionStorage.removeItem('isSubPageRefreshed');
        const currentPath = window.location.pathname;
        if (currentPath !== '/') {
          window.location.href = '/';
        }
      }
    });
  </script>
  <footer class="footer-container">
    <div class="footer-links">
      <a onclick="route()" href="/privacy-policy" class="footer-link" id="privacyPolicy">Privacy Policy</a>
      <a onclick="route()" href="/contact" class="footer-link" id="impressum">Impressum</a>
    </div>
  
    <div class="footer-text" style="text-align: right; padding-right: 30px;" id="madeWith">
      Made with</div><span class="heart-icon" style="font-size: 2em;">&#9829;</span> &nbsp;
      <div id="at42Vienna">at 42Vienna
    </div>
  </footer>
  
  <main>
    <div class="app" id="app"></div>
  </main>
  
  <script src="./router.js" defer></script>
  <script>
    let currentLanguage = 'en'; 
    updateNavigation();

    function changeLanguage(languageCode) {
      currentLanguage = languageCode; 
      translate(currentLanguage); 
    }
  

    function translate(lang) {

      fetch(`translations/${lang}.json`)
        .then(response => response.json())
        .then(translations => {

          Object.keys(translations).forEach(category => {
            Object.keys(translations[category]).forEach(key => {
              const element = document.getElementById(key);
              if (element) {
                element.innerHTML = translations[category][key];
              }
            });
          });
        })
        .catch(error => console.error('Error fetching translations:', error));
    }
  

    translate(currentLanguage);
  

    function updateNavigation() {
      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
      
      const navMenu = document.getElementById('nav-menu');
      navMenu.innerHTML = ''; 
  

      const menuItems = isLoggedIn ?
        ['Play!', 'Chat', 'Leaderboard', 'Profile', 'Logout'] :
        ['Home', 'Login'];
  

      menuItems.forEach(item => {
  const li = document.createElement('li');
  const a = document.createElement('a');
  a.classList.add('nav-item');
  a.href = `/${item.toLowerCase()}`;
  a.textContent = item;
  
  a.onclick = (event) => route(event, a.href); 
  li.appendChild(a);
  navMenu.appendChild(li);
});


    }
  

    window.addEventListener('load', () => {
      if (localStorage.getItem('isLoggedIn') === null) {
        localStorage.setItem('isLoggedIn', 'false');
      }
      updateNavigation();
    });
  </script>
  
  </body>
  </html>
